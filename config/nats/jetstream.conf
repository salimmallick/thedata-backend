# Server Configuration
server_name: $NATS_SERVER_NAME
port: 4222
http_port: 8222
debug: true
trace: true
logtime: true

# JetStream Configuration
jetstream {
    store_dir: "/data/jetstream"
    max_mem: $NATS_MEMORY_LIMIT
    max_file: 100gb
}

# System Accounts
accounts {
    SYS: {
        users: [
            {user: system, password: $SYSTEM_PASSWORD}
        ],
        limits: {
            max_connections: 10,
            max_subscriptions: 100,
            max_payload: 1mb
        }
    }
    
    ADMIN: {
        users: [
            {user: admin, password: $ADMIN_PASSWORD}
        ],
        limits: {
            max_connections: 50,
            max_subscriptions: 1000,
            max_payload: 8mb
        }
    }
    
    CLIENT: {
        users: [
            {user: client, password: $CLIENT_PASSWORD}
        ],
        limits: {
            max_connections: $NATS_MAX_CONNECTIONS,
            max_subscriptions: $NATS_MAX_SUBSCRIPTIONS,
            max_payload: 8mb
        }
    }
}

system_account: SYS

# Logging Configuration
log_file: "/var/log/nats/nats-server.log"

# Rate Limiting and Resource Management
max_connections: $NATS_MAX_CONNECTIONS
max_subscriptions: $NATS_MAX_SUBSCRIPTIONS
max_control_line: 4kb
max_pending: $NATS_MEMORY_LIMIT
write_deadline: "2s"